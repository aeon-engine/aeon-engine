build:
  script:
    - git submodule update --init
    - export WORKSPACE=$PWD
    - cd $AEON_LIBRARIES_PATH
    - git fetch --prune
    - git checkout origin/master
    - cd $WORKSPACE
    - export BUILD_DIR=ci_build
    - mkdir $BUILD_DIR
    - cd $BUILD_DIR
    - cmake -DCMAKE_INSTALL_PREFIX=install -DAEON_ENABLE_CLANG_COVERAGE=1 ../
    - cmake --build . --config Debug
    - lcov -b ../ -c -i -d . -o test.info
    - ctest -C Debug --verbose
    - lcov --remove test.info '/Applications/Xcode.app/*' '*/Gitlab/osx_clang/*' '*/tests/test_*' --output-file test.info.clean
    - lcov -l test.info.clean
